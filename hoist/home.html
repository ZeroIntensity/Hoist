<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Hoist V{{ version }}</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link
			rel="stylesheet"
			href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
		/>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	</head>
	<body>
		<style text="text/css">
			.nav-link {
				font-size: 18px;
				color: black;
			}

			.nav-link:hover {
				color: #32cd32;
			}
		</style>

		<nav class="navbar navbar-expand-sm bg-light justify-content-center">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="https://github.com/ZeroIntensity/Hoist"
						>GitHub</a
					>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="https://pypi.org/project/hoist3">PyPI</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="https://discord.gg/W9QwbpbUbJ">Discord</a>
				</li>
			</ul>
		</nav>
		<br />

		<div class="container-fluid text-center" style="margin-top: 10%">
			<h3 class="display-4" style="font-size: 60px">Hoist V{{ version }}</h3>
			<p style="font-size: 20px">App running successfully!</p>
		</div>
		<script type="text/javascript">
			const serverUrl = "{{ serverUrl }}";
			var auth = "";

			async function httpPost(url) {
				return await fetch(url, {
					method: "post",
					headers: {
						Accept: "application/json",
						"Content-Type": "application/json",
					},
				}).then(response => {
					return response.json();
				});
			}

			async function clicked() {
				const input = document.getElementById("message").value;
				const url = `${serverUrl}/send?msg=${input}&auth=${auth}`;
				var resp = httpPost(url, input);

				resp.then(json => {
					var element = document.getElementById("response");

					if (json.hasOwnProperty("ERROR")) {
						element.innerHTML = `<div class="container">
              <div class="alert alert-danger alert-dismissible">
<button type="button" class="close" data-dismiss="alert">&times;</button>
<strong>Error</strong> Server responded with error "${json["ERROR"]}"
</div></div>
              `;
					} else {
						element.innerHTML = `
              <div class="container">
              <div class="alert alert-success alert-dismissible">
<button type="button" class="close" data-dismiss="alert">&times;</button>
<strong>Response</strong> ${json["RESPONSE"]}
</div></div>
              `;
					}
				});

				return false;
			}
		</script>
	</body>
	<div class="container">
		<p style="font-size: 20px">Send Message To Server</p>
		<form>
			<div class="form-group">
				<input
					type="message"
					class="form-control"
					placeholder="Enter message..."
					name="message"
					id="message"
				/>
			</div>

			<button
				onclick="clicked(); return false;"
				type="submit"
				class="btn btn-success"
			>
				Send
			</button>
		</form>
		<div class="container" style="margin-top: 4%" id="response"></div>
	</div>
</html>
